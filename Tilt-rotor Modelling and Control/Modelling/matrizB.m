function B=matrizB(IN)

x=IN(1);
y=IN(2);
z=IN(3);
phi=IN(4);
theta=IN(5);
psii=IN(6);
aR=IN(7);
aL=IN(8);

B=[cos(aR).*((-0.871117E-1).*cos(phi)+0.996199E0.*sin(phi)).*sin(psii)+ ...
  cos(psii).*(cos(theta).*sin(aR)+cos(aR).*(0.996199E0.*cos(phi)+ ...
  0.871117E-1.*sin(phi)).*sin(theta)),cos(aL).*(0.871117E-1.*cos(phi)+ ...
  0.996199E0.*sin(phi)).*sin(psii)+cos(psii).*(cos(theta).*sin(aL)+cos(aL) ...
  .*(0.996199E0.*cos(phi)+(-0.871117E-1).*sin(phi)).*sin(theta)),0,0;cos( ...
  theta).*sin(aR).*sin(psii)+cos(aR).*(sin(phi).*((-0.996199E0).*cos(psii) ...
  +0.871117E-1.*sin(psii).*sin(theta))+cos(phi).*(0.871117E-1.*cos(psii)+ ...
  0.996199E0.*sin(psii).*sin(theta))),cos(theta).*sin(aL).*sin(psii)+cos( ...
  aL).*(sin(phi).*((-0.996199E0).*cos(psii)+(-0.871117E-1).*sin(psii).* ...
  sin(theta))+cos(phi).*((-0.871117E-1).*cos(psii)+0.996199E0.*sin(psii).* ...
  sin(theta))),0,0;cos(aR).*cos(theta).*(0.996199E0.*cos(phi)+ ...
  0.871117E-1.*sin(phi))+(-1).*sin(aR).*sin(theta),cos(aL).*cos(theta).*( ...
  0.996199E0.*cos(phi)+(-0.871117E-1).*sin(phi))+(-1).*sin(aL).*sin(theta) ...
  ,0,0;(-0.284713E0).*cos(aR)+0.178947E-1.*sin(aR),0.285919E0.*cos(aL)+( ...
  -0.178947E-1).*sin(aL),0,0;sin(aR).*(0.10052E0.*cos(phi)+(-0.27701E0).* ...
  sin(phi))+cos(aR).*((-0.277462E-2).*cos(phi)+(-0.182056E-1).*sin(phi)), ...
  cos(aL).*((-0.198763E-2).*cos(phi)+0.181368E-1.*sin(phi))+sin(aL).*( ...
  0.10052E0.*cos(phi)+0.27822E0.*sin(phi)),0,0;sin(aR).*(0.27701E0.*cos( ...
  phi).*cos(theta)+0.10052E0.*cos(theta).*sin(phi)+(-0.178947E-1).*sin( ...
  theta))+cos(aR).*(0.182056E-1.*cos(phi).*cos(theta)+(-0.277462E-2).*cos( ...
  theta).*sin(phi)+0.284713E0.*sin(theta)),cos(aL).*((-0.181368E-1).*cos( ...
  phi).*cos(theta)+(-0.198763E-2).*cos(theta).*sin(phi)+(-0.285919E0).* ...
  sin(theta))+sin(aL).*((-0.27822E0).*cos(phi).*cos(theta)+0.10052E0.*cos( ...
  theta).*sin(phi)+0.178947E-1.*sin(theta)),0,0;0,0,1,0;0,0,0,1];


end